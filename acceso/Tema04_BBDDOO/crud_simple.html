<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>CRUD Simple | Desarrollo  de  aplicaciones  que  gestionan  bases  de  datos  objeto  relacionales  y  orientadas  a objetos </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Gualberto Gutiérrez Marín" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" />
<meta name="generator" content="eXeLearning 2.1 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript">$exe_i18n={previous:"Anterior",next:"Siguiente",show:"Mostrar",hide:"Ocultar",showFeedback:"Mostrar retroalimentación",hideFeedback:"Ocultar retroalimentación",correct:"Correcto",incorrect:"Incorrecto",menu:"Menú",print:"Imprimir"}</script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header" ><div id="headerContent">Desarrollo  de  aplicaciones  que  gestionan  bases  de  datos  objeto  relacionales  y  orientadas  a objetos</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 5: BBDDOO</a></li>
   <li class="current-page-parent"><a href="bases_de_datos_nosql.html" class="current-page-parent daddy">Bases de datos NoSQL</a>
   <ul>
      <li><a href="tipos_de_bbdd_nosql.html" class="no-ch">Tipos de BBDD NoSQL</a></li>
      <li class="current-page-parent"><a href="mongodb.html" class="current-page-parent daddy">MongoDB</a>
      <ul>
         <li><a href="repaso_json.html" class="no-ch">Repaso JSON</a></li>
         <li><a href="instalacin.html" class="no-ch">Instalación</a></li>
         <li><a href="prueba_del_servidor.html" class="no-ch">Prueba del servidor</a></li>
         <li><a href="consulta_de_colecciones.html" class="no-ch">Consulta de colecciones</a></li>
         <li><a href="insercin_sencilla_de_datos.html" class="no-ch">Inserción sencilla de datos</a></li>
         <li><a href="cargar_ficheros_json.html" class="no-ch">Cargar ficheros JSON</a></li>
         <li id="active"><a href="crud_simple.html" class="active no-ch">CRUD Simple</a></li>
         <li><a href="base_de_datos_de_ejemplo.html" class="no-ch">Base de datos de ejemplo</a></li>
      </ul>
      </li>
      <li><a href="aplicaciones_full_stack_con_mongo.html" class="daddy">Aplicaciones Full Stack con Mongo</a>
      <ul class="other-section">
         <li><a href="proyectos_con_netbeans.html" class="daddy">Proyectos con Netbeans</a>
         <ul class="other-section">
            <li><a href="nuestra_primera_aplicacin_nodejs_y_mongodb.html" class="no-ch">Nuestra primera aplicación NodeJS y MongoDB</a></li>
         </ul>
         </li>
         <li><a href="proyectos_en_la_nube_con_bitnami_mean_vm.html" class="no-ch">Proyectos en la nube con Bitnami MEAN VM</a></li>
         <li><a href="ejemplo_crud.html" class="daddy">Ejemplo CRUD</a>
         <ul class="other-section">
            <li><a href="los_verbos_resthttp.html" class="no-ch">Los verbos REST/HTTP</a></li>
            <li><a href="read_alumno.html" class="no-ch">Read Alumno</a></li>
            <li><a href="create_alumno.html" class="no-ch">Create Alumno</a></li>
            <li><a href="delete_alumno.html" class="no-ch">Delete Alumno</a></li>
            <li><a href="update_alumno.html" class="no-ch">Update Alumno</a></li>
         </ul>
         </li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="sistemas_gestores_de_bases_de_datos_objetorelacional_ordbms.html" class="daddy">Sistemas Gestores de Bases de Datos Objeto-Relacional (ORDBMS)</a>
   <ul class="other-section">
      <li><a href="oracle_como_ordbms.html" class="no-ch">Oracle como ORDBMS</a></li>
      <li><a href="definiendo_el_objeto_cliente_en_oracle.html" class="no-ch">Definiendo el objeto Cliente en Oracle</a></li>
      <li><a href="defniendo_la_tabla_objeto_relacional_cliente.html" class="no-ch">Defniendo la tabla objeto relacional cliente</a></li>
      <li><a href="insercin_de_datos_en_un_ordb.html" class="no-ch">Inserción de datos en un ORDB</a></li>
   </ul>
   </li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="cargar_ficheros_json.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="base_de_datos_de_ejemplo.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">CRUD Simple</h1></div>
<div class="iDevice_wrapper objectivesIdevice em_iDevice" id="id19">
<div class="iDevice emphasis1" >
<div class="iDevice_header"><h2 class="iDeviceTitle">(C)reate</h2></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta19_101_2" class="block iDevice_content">
<p>Para crear un objeto en la <abbr title="Base de Datos">BBDD </abbr>usamos la función insert:</p>
<p>db.coleccion.insert( JSON )</p>
<p>Veámoslo con un ejemplo:</p>
<div class="pre-code">
<div>
<pre><code>db.profesor.insert(
{
nombre: "Juan",
apellido: "Gutierrez",
asignaturas: [
{nombre:"Lenguajes de Marcas", horas: 4} ,
{nombre:"Acceso a Datos", horas:5}]
}<br />)</code></pre>
</div>
</div>
<p></p>
<p> Pero, ¿y si no sabemos si existe? En un <a href="https://en.wikipedia.org/wiki/Relational_database_management_system" target="_blank">SGBDR </a>lo normal es que de un error de clave repetida. En Mongo tenemos la opción de usar el método "save" que, si ya existía ese objeto (lo comprueba mediante el identificador de objetos de Mongo (_id) lo actualiza y, en caso contrario, lo crea nuevo.</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper objectivesIdevice em_iDevice" id="id20">
<div class="iDevice emphasis1" >
<div class="iDevice_header"><h2 class="iDeviceTitle">(R)ead</h2></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta20_102_2" class="block iDevice_content">
<p>Para buscar un objeto en una colección usamos el método find. Así el formato para consultar la colección de antes sería:</p>
<div class="pre-code">
<div>
<pre><code>&gt; db.profesor.find( { "nombre":"Juan"}).pretty();
{
        "_id" : ObjectId("56d070d347ab7f3d3473c401"),
        "nombre" : "Juan",
        "apellido" : "Gutierrez",
        "asignaturas" : [
                {
                        "nombre" : "Lenguajes de Marcas",
                        "horas" : 4
                },
                {
                        "nombre" : "Acceso a Datos",
                        "horas" : 5
                }
        ]
}
&gt;</code></pre>
</div>
</div>
<p>Pero ¿y si quiero buscar profesore con asignaturas con más de 5 horas (inclusive)?</p>
<div class="pre-code">
<div>
<pre><code class="exe-clear">db.profesor.find(
   {
      asignaturas: {
                $elemMatch: {
                     horas: { $gt: 4}
                }
      }
   }
</code></pre>
</div>
</div>
<p>Así el formato de consulta responde al modelo:</p>
<p>COLECCION . CRITERIOS DE CONSULTA . MODIFICADOR</p>
<p>Donde:</p>
<ul>
<li>COLECCION: es la colección de la base de datos que queremos consultar: db.alumnos</li>
<li>CRITERIOS DE CONSULTA: es el método y objetos que le pasamos como parámetro: find()</li>
<li>MODIFICADOR: es el formato y/o opciones de salida, por ejemplo .pretty() ó .sort()</li>
</ul>
<p>Imaginemos ahora que queremos buscar nombres de alumnos con ID mayor estricto que 4. Sería así:</p>
<div class="pre-code">
<div>
<pre><code>&gt; db.alumnos.find({id:{$gt:4}},{nombre:1});
{ "_id" : ObjectId("56d2e5328e3e22ad41bedd1b"), "nombre" : "IGNACIO" }</code></pre>
</div>
</div>
<p></p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper objectivesIdevice em_iDevice" id="id21">
<div class="iDevice emphasis1" >
<div class="iDevice_header"><h2 class="iDeviceTitle">(U)pdate</h2></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta21_103_2" class="block iDevice_content">
<p>Insertamos una colección y actualizamos un alumno</p>
<div class="pre-code">
<div>
<pre><code>&gt; db.alumnos.insert( [{ "apellido" : "PEREZ", "id" : 1, "nombre" : "PEPE" }, { "apellido" : "MARTINEZ", "id" : 2, "nombre" : "DANIEL" }, { "apellido" : "GOMEZ", "id" : 3, "nombre" : "JUAN" }, { "apellido" : "FERNANDEZ", "id" : 4, "nombre" : "ROCIO" }, { "apellido" : "MONTORO", "id" : 5, "nombre" : "IGNACIO" } ]);

&gt; db.alumnos.update({id:5},{$set:{apellido: "GARCIEZ"}});

</code></pre>
</div>
</div>
<p></p>
<div class="pre-code">
<div>
<pre><code>&gt; db.alumnos.find().pretty();
{
        "_id" : ObjectId("56d2e5328e3e22ad41bedd17"),
        "apellido" : "PEREZ",
        "id" : 1,
        "nombre" : "PEPE"
}
{
        "_id" : ObjectId("56d2e5328e3e22ad41bedd18"),
        "apellido" : "MARTINEZ",
        "id" : 2,
        "nombre" : "DANIEL"
}
{
        "_id" : ObjectId("56d2e5328e3e22ad41bedd19"),
        "apellido" : "GOMEZ",
        "id" : 3,
        "nombre" : "JUAN"
}
{
        "_id" : ObjectId("56d2e5328e3e22ad41bedd1a"),
        "apellido" : "FERNANDEZ",
        "id" : 4,
        "nombre" : "ROCIO"
}
{
        "_id" : ObjectId("56d2e5328e3e22ad41bedd1b"),
        "apellido" : "GARCIEZ",
        "id" : 5,
        "nombre" : "IGNACIO"
}</code></pre>
</div>
</div>
<p></p>
<p></p>
<p></p>
<p></p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper objectivesIdevice em_iDevice" id="id22">
<div class="iDevice emphasis1" >
<div class="iDevice_header"><h2 class="iDeviceTitle">(D)elete</h2></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta22_104_2" class="block iDevice_content">
<p>Para eliminar un objeto de una colección usamos el método "remove()". La sintaxis sería: db.COLECCION.remove(CRITERIO). Veamos un ejemplo:</p>
<div class="pre-code">
<div>
<pre><code>&gt; db.alumnos.remove({"nombre":"IGNACIO"});
WriteResult({ "nRemoved" : 1 })</code></pre>
</div>
</div>
<p></p>
</div>
</div>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-nd">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Licencia Creative Commons Reconocimiento No comercial Sin obra derivada 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="cargar_ficheros_json.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="base_de_datos_de_ejemplo.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="siteFooter">Desarrollo de Aplicaciones Multiplataforma
Juan Gualberto Gutiérrez Marín
jgutierrez@iesvirgendelcarmen.com
IES Virgen del Carmen</div></div>
<script type="text/javascript" src="_max_js.js"></script></body></html>